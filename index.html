<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <script src="https://cloudcache.tencent-cloud.com/open/qcloud/live/webrtc/js/TXLivePusher-1.0.2.min.js" charset="utf-8"></script>
  <div id="id_local_video" style="width:100%;height:500px;display:flex;align-items:center;justify-content:center;"></div>
  <script>
    var hasVideo = false;
    var hasAudio = false;
    var isPush = false;

    const livePusher = new TXLivePusher();
    livePusher.setRenderView('id_local_video');
    // 设置视频质量
    livePusher.setVideoQuality('720p');
    // 设置音频质量
    livePusher.setAudioQuality('standard');
    // 自定义设置帧率
    livePusher.setProperty('setVideoFPS', 25);
    // 打开摄像头
    // livePusher.startCamera();
    // 打开麦克风
    livePusher.startMicrophone();

    livePusher.setObserver({
      onCaptureFirstAudioFrame: function() {
        hasAudio = true;
        if (hasVideo && !isPush) {
          isPush = true;
          // livePusher.startPush('webrtc://domain/AppName/StreamName?txSecret=xxx&txTime=xxx');
          livePusher.startPush('webrtc://localhost:1935');
        }
      },
      onCaptureFirstVideoFrame: function() {
        hasVideo = true;
        if (hasAudio && !isPush) {
          isPush = true;
          // livePusher.startPush('webrtc://domain/AppName/StreamName?txSecret=xxx&txTime=xxx');
          livePusher.startPush('webrtc://localhost:1935');
        }
      }
    });
  </script>
</body>
</html>